# Implementation Plan: Testing and Documentation

**Branch**: `006-testing-docs` | **Date**: 2026-01-16 | **Spec**: [spec.md](./spec.md)
**Input**: Feature specification from `/specs/006-testing-docs/spec.md`

## Summary

Implement comprehensive test coverage (70%+) and documentation for LegalDocs Manager. This includes unit tests for models, serializers, and ViewSets; integration tests for end-to-end workflows; demo data fixtures with a management command; and complete documentation (README.md, API_DOCS.md, DEPLOYMENT.md).

## Technical Context

**Language/Version**: Python 3.11+
**Primary Dependencies**: Django 5.x, Django REST Framework 3.15+, coverage.py
**Storage**: PostgreSQL 15+ (SQLite for tests)
**Testing**: Django TestCase, DRF APITestCase, coverage.py
**Target Platform**: Linux server (Django backend)
**Project Type**: Web application (Django)
**Performance Goals**: Tests run < 30 seconds
**Constraints**: 70%+ code coverage minimum
**Scale/Scope**: 3 models, 4 ViewSets, 8 API endpoints, 20+ clients, 30+ cases, 50+ documents

## Constitution Check

*GATE: Must pass before Phase 0 research. Re-check after Phase 1 design.*

| Principle | Status | Notes |
|-----------|--------|-------|
| Django Best Practices First | ✅ PASS | Using Django TestCase, fixtures, management commands |
| Clean Architecture | ✅ PASS | Tests organized per-app with tests/ directories |
| API-First Design | ✅ PASS | Testing all REST endpoints, documenting API |
| Documentation is Mandatory | ✅ PASS | Core deliverable of this feature |
| Security by Default | ✅ PASS | Testing permission enforcement |

**Post-Design Re-Check**: All gates pass. No violations.

## Project Structure

### Documentation (this feature)

```text
specs/006-testing-docs/
├── plan.md              # This file
├── research.md          # Research findings
├── data-model.md        # N/A - no new models
├── quickstart.md        # Test and doc verification guide
└── tasks.md             # Generated by /speckit.tasks
```

### Source Code (repository root)

```text
legaldocs/
├── clients/
│   └── tests/
│       ├── __init__.py
│       ├── test_models.py      # Client model tests
│       └── test_views.py       # ClientViewSet tests
├── cases/
│   └── tests/
│       ├── __init__.py
│       ├── test_models.py      # Case model tests (incl. manager)
│       └── test_views.py       # CaseViewSet tests
├── documents/
│   └── tests/
│       ├── __init__.py
│       ├── test_models.py      # Document model tests
│       └── test_views.py       # DocumentViewSet tests (file uploads)
├── api/
│   └── tests/
│       ├── __init__.py
│       ├── test_auth.py        # (existing)
│       ├── test_dashboard.py   # (existing)
│       ├── test_search.py      # (existing)
│       ├── test_profile.py     # (existing)
│       └── test_integration.py # New end-to-end workflow tests
├── core/
│   └── management/
│       └── commands/
│           └── load_demo_data.py  # Management command
└── fixtures/
    ├── demo_clients.json
    ├── demo_cases.json
    └── demo_documents.json

/  (repository root)
├── README.md            # Project documentation
├── API_DOCS.md          # API reference
└── DEPLOYMENT.md        # Deployment guide
```

**Structure Decision**: Per-app tests/ directories following Django conventions. Documentation files at repository root for visibility. Fixtures in legaldocs/fixtures/ per constitution.

## Complexity Tracking

No violations to justify. All decisions align with constitution and Django best practices.

## Implementation Phases

### Phase 1: Setup
- Add coverage.py to requirements
- Create test directory structure for clients, cases, documents
- Verify existing api/tests/ works

### Phase 2: Unit Tests - Models (US1)
- Client model tests: creation, validation, __str__
- Case model tests: creation, auto-generated case_number, manager methods
- Document model tests: creation, file_size calculation

### Phase 3: Unit Tests - Serializers (US1)
- ClientSerializer/ClientDetailSerializer tests
- CaseSerializer/CaseDetailSerializer tests
- DocumentSerializer tests

### Phase 4: Unit Tests - ViewSets (US1)
- ClientViewSet: CRUD, filtering, search, custom action (cases)
- CaseViewSet: CRUD, filtering, custom actions (close, statistics)
- DocumentViewSet: CRUD, file upload, permissions

### Phase 5: Integration Tests (US2)
- Complete workflow: create client → case → document
- Dashboard statistics accuracy
- Search functionality across models
- Authentication flow

### Phase 6: Demo Data (US5)
- Create JSON fixtures with realistic legal data
- Create load_demo_data management command

### Phase 7: Documentation (US3, US4, US6)
- README.md: Project overview, installation, usage
- API_DOCS.md: Endpoint reference with examples
- DEPLOYMENT.md: Production deployment guide

### Phase 8: Validation
- Run full test suite with coverage
- Verify 70%+ coverage achieved
- Review all documentation for accuracy

## Key Files to Create/Modify

| File | Action | Purpose |
|------|--------|---------|
| requirements.txt | Modify | Add coverage |
| clients/tests/__init__.py | Create | Package marker |
| clients/tests/test_models.py | Create | Client model tests |
| clients/tests/test_views.py | Create | ClientViewSet tests |
| cases/tests/__init__.py | Create | Package marker |
| cases/tests/test_models.py | Create | Case model tests |
| cases/tests/test_views.py | Create | CaseViewSet tests |
| documents/tests/__init__.py | Create | Package marker |
| documents/tests/test_models.py | Create | Document model tests |
| documents/tests/test_views.py | Create | DocumentViewSet tests |
| api/tests/test_integration.py | Create | E2E workflow tests |
| core/management/commands/load_demo_data.py | Create | Demo data command |
| fixtures/demo_clients.json | Create | 20+ clients |
| fixtures/demo_cases.json | Create | 30+ cases |
| fixtures/demo_documents.json | Create | 50+ documents |
| README.md | Create | Project documentation |
| API_DOCS.md | Create | API reference |
| DEPLOYMENT.md | Create | Deployment guide |

## Test Coverage Plan

| Component | Target | Test Focus |
|-----------|--------|------------|
| Client model | 80%+ | Creation, validation, __str__ |
| Case model | 80%+ | Creation, case_number generation, manager |
| Document model | 80%+ | Creation, file_size calculation |
| Serializers | 80%+ | Valid/invalid data, computed fields |
| ViewSets | 70%+ | CRUD, filters, permissions, custom actions |
| Integration | 70%+ | End-to-end workflows |

## Success Criteria

1. ✅ All existing tests pass (40 tests)
2. ✅ New tests pass (estimated 60+ additional tests)
3. ✅ Code coverage ≥ 70%
4. ✅ README.md complete with all required sections
5. ✅ API_DOCS.md documents all endpoints
6. ✅ DEPLOYMENT.md covers production setup
7. ✅ `python manage.py load_demo_data` works
8. ✅ Fixtures contain 20+ clients, 30+ cases, 50+ documents
