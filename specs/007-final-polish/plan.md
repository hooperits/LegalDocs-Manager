# Implementation Plan: Final Polish

**Branch**: `007-final-polish` | **Date**: 2026-01-16 | **Spec**: [spec.md](./spec.md)
**Input**: Feature specification from `/specs/007-final-polish/spec.md`

## Summary

Final polish and production hardening for LegalDocs Manager. This feature focuses on code quality (docstrings, type hints), security hardening (rate limiting, file validation), performance optimization (indexes, caching, query optimization), user experience (Spanish error messages), and professional presentation (demo materials, repository polish).

## Technical Context

**Language/Version**: Python 3.11+ + Django 5.x, Django REST Framework 3.15+
**Primary Dependencies**: django-ratelimit 4.1+, python-magic 0.4.27+ (new); existing stack unchanged
**Storage**: PostgreSQL 15+ (existing); Django cache framework (new for dashboard caching)
**Testing**: Django TestCase, DRF APITestCase, coverage.py (existing 99% coverage)
**Target Platform**: Linux server (Django backend)
**Project Type**: Web application (Django REST API)
**Performance Goals**: < 200ms response time for list endpoints; 5 req/min rate limit on auth
**Constraints**: Maintain 70%+ code coverage; no breaking API changes
**Scale/Scope**: Existing 3 models, 4 ViewSets, 8 API endpoints; adding docstrings to ~20 files

## Constitution Check

*GATE: Must pass before Phase 0 research. Re-check after Phase 1 design.*

| Principle | Status | Notes |
|-----------|--------|-------|
| Django Best Practices First | ✅ PASS | Using Django cache framework, built-in validators |
| Clean Architecture | ✅ PASS | No changes to app structure; new utilities in core/ |
| API-First Design | ✅ PASS | Optimizing existing API, no new endpoints |
| Documentation is Mandatory | ✅ PASS | Core deliverable - adding docstrings to all code |
| Security by Default | ✅ PASS | Core deliverable - rate limiting, file validation |

**Post-Design Re-Check**: All gates pass. No violations.

## Project Structure

### Documentation (this feature)

```text
specs/007-final-polish/
├── plan.md              # This file
├── research.md          # Research findings
├── data-model.md        # Index changes only (no new models)
├── quickstart.md        # Verification guide
└── tasks.md             # Generated by /speckit.tasks
```

### Source Code (repository root)

```text
legaldocs/
├── clients/
│   ├── models.py          # Add docstrings
│   ├── serializers.py     # Add docstrings, Spanish errors
│   └── views.py           # Add docstrings, optimize queries
├── cases/
│   ├── models.py          # Add docstrings, indexes
│   ├── serializers.py     # Add docstrings, Spanish errors
│   └── views.py           # Add docstrings, optimize queries
├── documents/
│   ├── models.py          # Add docstrings, indexes
│   ├── serializers.py     # Add docstrings, Spanish errors
│   ├── views.py           # Add docstrings, file validation
│   └── validators.py      # NEW: File upload validators
├── api/
│   ├── views.py           # Add caching, rate limiting
│   ├── exceptions.py      # NEW: Custom exception handler
│   └── throttling.py      # NEW: Rate limiting config
└── core/
    └── cache.py           # NEW: Cache utilities

/  (repository root)
├── README.md              # Add screenshots, badges
├── LICENSE                # NEW: MIT license
├── docs/
│   ├── images/           # NEW: Screenshots
│   └── demo-script.md    # NEW: Demo walkthrough
└── postman/
    └── LegalDocs-API.postman_collection.json  # NEW
```

**Structure Decision**: Minimal new files. Most work is enhancing existing files with docstrings, type hints, and optimizations. New files only for validators, exception handler, throttling config, cache utilities, and demo materials.

## Complexity Tracking

No violations to justify. All decisions align with constitution and Django best practices.

## Implementation Phases

### Phase 1: Code Quality (US1)
- Add docstrings to all models (Client, Case, Document)
- Add docstrings to all serializers
- Add docstrings to all views/viewsets
- Add type hints to key functions
- Run linter and fix issues
- Remove unused imports/dead code

### Phase 2: Security Hardening (US2)
- Add django-ratelimit dependency
- Add python-magic dependency
- Create file upload validators (type + size)
- Add rate limiting to login/register endpoints
- Review CORS settings for production
- Audit serializers for sensitive data exposure

### Phase 3: Performance Optimization (US3)
- Add database indexes to Case and Document models
- Run migrations for indexes
- Add select_related/prefetch_related to querysets
- Implement dashboard caching (5-minute TTL)
- Create cache table migration

### Phase 4: User Experience (US4)
- Create custom DRF exception handler
- Translate error messages to Spanish
- Configure date formats in settings
- Map field names to Spanish labels

### Phase 5: Final Testing (US5)
- Create manual test checklist
- Execute all test scenarios
- Document any issues found
- Verify with large dataset

### Phase 6: Demo Preparation (US6)
- Write demo script (5-minute walkthrough)
- Create Postman collection
- Capture screenshots
- Prepare demo environment setup

### Phase 7: Repository Polish (US7)
- Add MIT LICENSE file
- Update README with screenshots and badges
- Create v1.0.0 release tag
- Verify .gitignore is comprehensive

## Key Files to Create/Modify

| File | Action | Purpose |
|------|--------|---------|
| clients/models.py | Modify | Add docstrings |
| clients/serializers.py | Modify | Add docstrings, Spanish errors |
| clients/views.py | Modify | Add docstrings, optimize queries |
| cases/models.py | Modify | Add docstrings, indexes |
| cases/serializers.py | Modify | Add docstrings, Spanish errors |
| cases/views.py | Modify | Add docstrings, optimize queries |
| documents/models.py | Modify | Add docstrings, indexes |
| documents/serializers.py | Modify | Add docstrings, Spanish errors |
| documents/views.py | Modify | Add docstrings, file validation |
| documents/validators.py | Create | File upload validators |
| api/views.py | Modify | Add caching, rate limiting |
| api/exceptions.py | Create | Custom exception handler |
| api/throttling.py | Create | Rate limiting config |
| core/cache.py | Create | Cache utilities |
| legaldocs/settings.py | Modify | Cache, rate limit, date format settings |
| requirements.txt | Modify | Add django-ratelimit, python-magic |
| README.md | Modify | Add screenshots, badges |
| LICENSE | Create | MIT license |
| docs/demo-script.md | Create | Demo walkthrough |
| postman/LegalDocs-API.postman_collection.json | Create | API collection |

## Dependencies

```text
# New dependencies
django-ratelimit>=4.1.0
python-magic>=0.4.27
```

## Success Criteria

1. ✅ All models, serializers, views have docstrings
2. ✅ File upload validates type and size (10MB limit)
3. ✅ Rate limiting active on auth endpoints (5/min)
4. ✅ Dashboard cached (5-minute TTL)
5. ✅ All error messages in Spanish
6. ✅ Database indexes added
7. ✅ All existing tests pass
8. ✅ Coverage maintained at 70%+
9. ✅ Postman collection complete
10. ✅ LICENSE file present
11. ✅ v1.0.0 tag created
